# なぜC言語を学ぶのか

## C言語が使われ続けるのはなぜか

> 「C言語ってイイんですか？プロならC言語を使うって聞きました！」

乱暴な質問だなあ。別にC言語以外でプログラムを書いている
スーパープログラマーは世の中にごまんと居るし、
プログラミング言語なんて適材適所なんだから、
C言語で開発するのが適しているプログラムはC言語で書けば良いし、
そうじゃないものは違う言語で書けばいいよ。

むしろ、ちょっとしたツールやWebサイトの開発なんかには
C言語を使うことはないだろうね。
スマートフォンアプリやプレイステーションのゲームなども
C言語では書かれていないんじゃないかな。

ただ、C言語はプログラマにとって特別なポジションを占めている
プログラミング言語であることは確かでさ、
代わりになる言語がほとんど無いんだよ。
コンピュータに事務処理をさせたり、
コンピュータで遠くの人とコミュニケーションしたり、
コンピュータに計算をさせたりするのではなく、
コンピュータという機械そのものを操作したいときに
C言語は一番力を発揮する。
だから、デバイスドライバやオペレーティングシステム、
プログラミング言語処理系など、私たちプログラマがコンピュータを使うための
下支えをしてくれるようなプログラムを書くには、
C言語はもってこいさ。

それはLinus TorvaldsさんがC言語でLinuxを作ったり、
Matz(まつもとゆきひろ)さんがC言語でRubyを作ったことでもわかるよね。
C言語を自在に操れない奴を誰も凄腕のハッカーとは認めないし、
逆に機械としてのコンピュータを理解していないとC言語はよくわからない。
そうだね、C言語が出来なくてもプロのプログラマを名乗るのに
なんの問題もないけども、C言語が出来ないとハッカーにはなれないかな。

> 「ハッカーって悪い人ですよね？ハッカーになったらケーサツが来ちゃいますよ？」

また定番のFAQを・・・。ハッカーという言葉にもともと悪い意味は
無かったそうだよ。この業界にはハッカーという言葉を犯罪者という意味で
使うと、気分を害する人が多く居るから気をつけて。

それにハッカーじゃなくてもケーサツは来るらしいしね。

## 「ポインタ」がわからないのはなぜか

> 「カッコイイからC言語を勉強しようとしたら、
> みんながポインタが難しいぞーって言ってくるんです。
> 難しいのはイヤなので、ポインタ抜きで教えて下さい！」

そんなこと言われてもなあ・・・。Javaでプログラムを書くときに
メインメソッドを

```java
public static void main(String arg[]){
```

こう書くよね？

これと同じ役割のコードはC言語では

```c
int main(int argc, char **argv){
```

になるんだけど、argvはchar型のポインタのポインタだよ？
避けては通れないんじゃないかなあ。

> 「別の先輩にも同じお願いをしてみたんですけど、
> ポインタがわからずにC言語がわかるかって言われちゃいました」

あはは。まあ、一理ある。ポインタを使わずにC言語らしい
プログラムを書くことはできないと、私も思うよ。
ポインタを直接扱えることが、すなわちコンピュータを
機械として扱えるということと直接対応するんだ。
ポインタが難しいと言われる原因は、
機械としてのコンピュータとはどういうものなのかを理解していないことだ。
ポインタを使ってそもそも何がしたいのかがわからないから、
ポインタがどういうものなのかが理解できないんだよ。

ポインタは決して難しい概念じゃない。
でも、正しく扱うのは面倒だし、操作を間違うと調査の難しい酷いバグを生む。
それどころか、セキュリティホールを作ってしまうかも知れないので
危険ですらある。
だから、C言語より後に生まれた言語で、ポインタを直接扱える言語は
あまりないんだ。
むしろ、C言語のポインタ操作のような
危険なことをプログラマが出来ないようにプログラム言語処理系が
頑張るようになった。そうやってコンピュータに頑張ってもらうと、
当然のことながら、効率は落ちる。
だから、「C言語は速い」と言われるんだ。

でも、コンピュータの性能はこの何十年の間、どんどん上がってる。
その結果、C言語の「速い」という特性よりも
他の言語の「書きやすくて安全」という特性の方が好まれるようになってきた。
以前はプログラムが速いことはとても大事なことだったので、
C言語の出番はとても多かった。
でも、コンピュータの性能が十分上がったので、
私たちが日常のプログラミングでC言語を使う機会はめっきり減ったというわけさ。

## C言語でプログラミングをするべきか

> 「じゃあ、もうC言語でプログラミングする必要はないんですね！」

ほとんどの人にとって、必要はないと思うね。
でもね、機械としてのコンピュータを勉強したくはないかい？
そのためには、C言語はぴったりの教材だ。

機械としてのコンピュータといっても、コンピュータは複雑な機械だ。
なんとなく使っているコンピュータだけど、どういう仕組みで動いているのか
イメージできているかい？

仕組みといっても、いろんなレベルがある。

例えば、自動車の仕組みを考えてみようか。
自動車にはエンジンがある。エンジンで作った「ものを回す力」を
後輪タイヤに伝わる仕組みが付いていて、車を前に動かしてくれる。
エンジンを速く回すにはアクセルペダルを踏み込む。すると、
燃料が多くエンジンに供給されてより回す力が強くなり、速く走り出す。
車輪には、ブレーキというものを挟み付けて動きを止める機構があり、
ブレーキペダルを踏み込むとタイヤを摩擦力で動かないように止めてくれる。
前輪にはタイヤを垂直方向からみて右左に回転させる装置がついていて、
ハンドルを回すとそれにともなってタイヤが回転し、車は曲がる。

このぐらいの仕組みを知っていれば車を運転することが出来る。

え？わかってなかった？免許を持っているのに？
うーん、まあ、最近の車はめったに壊れることもないから
気にしないのかも知れないなあ。
でも、ブレーキを踏んだら変な音がするとか、
雪道にはまり込んだなんて時には、車の仕組みをちゃんとわかっていることが
身を助けることになる。
だから、このぐらいの単純化された機械としての自動車の仕組みは
知っておいた方がいい。

しかし、どのレベルまで知っておけばいいのかという疑問はあるよね。
エンジンというのは、ピストンの中で空気とガソリンを混ぜたものを
爆発させて、その勢いで上下の運動を作り、それをカムシャフトで
回転に変えている。これはエンジンのすごく基本的な仕組みだけど、
車を運転する人が知っているべきかどうかはちょっと疑問だ。

そして、もっと言えば、空気とガソリンが混ざって火が付くと
化学としてどんな反応が起きるかとか、熱力学の法則的に熱エネルギーから
仕事を取り出すとはどんなことかとか、「そもそもどういう仕組みか」を
問いはじめると、どんどんと突き詰めていける。

あるいは、最新の車はハイブリッド車が増えていて、エンジンの仕組みも
ブレーキの仕組みも複雑になっている。パワーステアリングがあれば、
ハンドルと前輪の関係も簡単じゃない。
でも、そのような本当の仕組みは運転者が意識しなくてもよいことになっている。

C言語は、ちょうどこの「車を運転する人にとっての機械」のレベルを
扱うように出来ている。適切なタイミングでブレーキを踏んで、ハンドルを回し、
アクセルを踏んで車を進ませる。失敗すると人をひき殺すかもしれない。
Rubyのような言語は、自動運転車だ。行きたい場所を伝えると、
最適と思われる道を最適と思われる速度で進んでいく。事故は起きない。
指示も簡潔で済む。いいことずくめだよね。

でも、「この信号で引っかかったら、のろのろ進むとどんどんタイミング
悪く信号にひっかかり続けるんだよな。2つ目の信号までトばして赤になる
ぎりぎり前に通過してしまえば、あとはタイミング良く進めるんだけど」と
いうようなことにはRubyでは対応できない。
だから、C言語は速くて効率的なプログラムを
作ることができるんだ。もちろん、運転手の腕は必要だけど。

じゃあ、「運転する人が理解しておくべき機械としての自動車」にあたる
「プログラミングする人が理解しておくべき機械としてのコンピュータ」って
どういうものだろう。これは、C言語のプログラマにとっては共通の概念なんだけど、
C言語を触ったことがないプログラマはあんがい知らないものなんだ。
そして、この共通の概念、いわばC言語がモデル化したコンピュータというものが
コンピュータを理解する上で非常に扱いやすく便利だったことが
C言語がプログラマにとって特別なポジションにいることの理由なんだよ。

おっ？興味出てきた？じゃあ、ちょっと説明してみようか。
コンピュータを深く知るためのC言語講座。
勉強しても決してC言語でプログラムを書けるようにはならないけど、
C言語を通して見た世界の姿についてわかるようになるためのお話だ。


